<h2><%= @room.member.nickname %>のRoom</h2>
<div class="post-show-container">
  <div class="row">


          <div class="col-xs-6">
            <div class="room-image">
            <table class="table">
              <tr>
              <td>
                <%= attachment_image_tag @room, :image, :limit, 300, 300, fallback: "no_image.jpg",size: "430x430" %>
                </td>
              </tr>
              <% if member_signed_in? %>

                 <% if @room.favorited_by?(current_member) %>
              <tr>
                      <td><%= @room.created_at.strftime("%Y-%m-%d %H:%M") %>
                　        <%= link_to room_favorites_path(@room), method: :delete, remote: true do %>
                           <i class="fas fa-heart" aria-hidden="true" style="color: red;"></i>
                           <%= @room.favorites.count %> いいね
                         <% end %>
                         <%= link_to room_path(@room.id) do %>
                           <i class="fa fa-comment"></i>
                           <%= @room.room_comments.count %>
                         <% end %>
                      </td>
                    </tr>


                 <% else %>

                    <tr>
                      <td>
                          <%= @room.created_at %>
                          <%= link_to room_favorites_path(@room), method: :post, remote: true do %>
                             <i class="far fa-heart" aria-hidden="true"></i>
                             <%= @room.favorites.count %> いいね
                          <% end %>

                          <%= link_to room_path(@room.id) do %>
                             <i class="fa fa-comment"></i>
                             <%= @room.room_comments.count %>
                          <% end %>
                      </td>
                    </tr>

                 <% end %>
                <% end %>
              </table>
            </div>
           </div>

           <div class="col-xs-6">
             <div class="room-production-table">
               <table class="table">
                 <tr>
                   <td>
                     <%= link_to member_path(@member.id) do %>
                      <%= attachment_image_tag @member, :profile_image, :limit, 80, 80, class:"img-circle", fallback: "no_image.jpg",size: "80x80" %>
                     <% end %>
                   </td>
                   <td><%= @member.nickname %></td>
                 </tr>
                 <tr>
                    <th>間取り</th>
                    <td><%= @room.room_layout.layout_name %></td>
                 </tr>
                 <tr>
                    <th>広さ</th>
                    <td><%= @room.size %>畳</td>
                 </tr>
                 <tr>
                    <th>部屋の種類</th>
                    <td><%= @room.room_genre.genre_name %></td>
                 </tr>
                 <tr>
                    <th>イメージ</th>
                    <td><%= @room.room_image.image_name %></td>
                 </tr>
                 <tr>
                    <th>説明</th>
                    <td><%= text_url_to_link(h(@room.production)).html_safe %></td>
                 </tr>
               </table>

              <% if @room.member == current_member %>
                <div class="text-right">
                  <%= link_to "編集する", edit_room_path(@room.id) %>
                  <%= link_to '削除', room_path(@room.id), method: :delete, data: {confirm: "Are you sure?"} %>
                </div>
              <% end %>
             </div>
           </div>
           <div class="col-xs-2"></div>
    </div>
  </div>
<!-- コメント -->
  <div id="comments_area">
    <h3><i class="fa fa-comment"></i> コメント　<%= @room.room_comments.count %>件</h3>
      <div class="room_comment_container">
        <% @room_comments.each do |room_comment| %>
            <% if room_comment.parent_id.present? || room_comment.id.blank? %>
              <% next %>
            <% end %>
      <!-- 親コメント一覧 -->
          <p>
            <%= attachment_image_tag room_comment.member, :profile_image, :limit, 80, 80, class:"img-circle", fallback: "no_image.jpg",size: "80x80" %>
            <%= room_comment.member.nickname %> : <%= text_url_to_link(h(room_comment.comment)).html_safe %>
          </p>
          <%=room_comment.created_at.strftime("%Y-%m-%d %H:%M") %>
          <%= link_to "削除", room_room_comment_path(@room, room_comment), method: :delete %>
          <!-- 返信コメント一覧 -->
          <div id="reply_area">
            <% room_comment.replies.order(:created_at).each do |reply| %>
              <p>
                <%= attachment_image_tag reply.member, :profile_image, :limit, 80, 80, class:"img-circle", fallback: "no_image.jpg",size: "50x50" %>
                <%= reply.member.nickname %> : <%= text_url_to_link(h(reply.comment)).html_safe %>
              </p>
                <%=reply.created_at.strftime("%Y-%m-%d %H:%M") %>
            <% end %>
          </div>

          <button type="button" class="btn btn-success" data-toggle="modal" data-target="#modalForm" data-cusno=1 data-visitday="2019-07-01" onClick="inputCommentParentId(<%=room_comment.id%>)">
           返信
          </button>
        <% end %>
    <!-- 親コメント入力フォーム -->
        <%= form_with(model:[@room,@room_comment],local:true) do |form| %>
        <br>
          <p>
            <label>コメント</label>
          </p>
          <%= form.text_area :comment, class: "form-control input-form"  %>
          <!--<textarea class="form-control input-form" name="comment[content]" rows="5"><%#= @room_comment.comment %></textarea>-->
          <%= form.hidden_field :room_id, value: @room.id %>
          <br>
          <div class="actions">
            <%= form.submit "送信" %>
          </div>
        <% end %>
     </div>
  </div>

<!-- モーダルフォーム -->
  <div class="modal fade" id="modalForm" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
      <!-- Modal ヘッダー -->
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">
            <span aria-hidden="true">×</span>
            <span class="sr-only">閉じる</span>
          </button>
        </div>
      <!-- 返信コメント入力フォーム -->
          <div class="modal-body">
            <div class="form-group">
              <%= form_with(model:[@room, @room_comment_reply],local:true) do |form| %>
                 <%= form.text_area :comment, class: "form-control input-form" %>
                 <!--<textarea class="form-control input-form" name="comment[content]" rows="2"><%#=@room_comment_reply.comment%></textarea>-->
                 <%= form.hidden_field :room_id, value: @room.id %>
                 <%= form.hidden_field :parent_id %>
             </div>

                <div class="actions">
                  <%= form.submit "送信" %>
                </div>
              <% end %>
            </div>
          </div>
